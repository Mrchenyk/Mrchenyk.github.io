<!DOCTYPE html>
<html lang="en-US" dir="ltr">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Redis | &amp;&amp;-blog</title>
    <meta name="description" content="A-Cool-Blog">
    <meta name="generator" content="VitePress v1.5.0">
    <link rel="preload stylesheet" href="/assets/style.Dl4tJfRi.css" as="style">
    <link rel="preload stylesheet" href="/vp-icons.css" as="style">
    
    <script type="module" src="/assets/app.DnBCJ9Ah.js"></script>
    <link rel="preload" href="/assets/inter-roman-latin.Di8DUHzh.woff2" as="font" type="font/woff2" crossorigin="">
    <link rel="modulepreload" href="/assets/chunks/theme.gxUU_NUv.js">
    <link rel="modulepreload" href="/assets/chunks/framework.DLL39-MI.js">
    <link rel="modulepreload" href="/assets/Notes_Learning_Redis.md.C0gabYRo.lean.js">
    <script id="check-dark-mode">(()=>{const e=localStorage.getItem("vitepress-theme-appearance")||"auto",a=window.matchMedia("(prefers-color-scheme: dark)").matches;(!e||e==="auto"?a:e==="dark")&&document.documentElement.classList.add("dark")})();</script>
    <script id="check-mac-os">document.documentElement.classList.toggle("mac",/Mac|iPhone|iPod|iPad/i.test(navigator.platform));</script>
  </head>
  <body>
    <div id="app"><div class="Layout" data-v-1f115b32><!--[--><!--]--><!--[--><span tabindex="-1" data-v-0f60ec36></span><a href="#VPContent" class="VPSkipLink visually-hidden" data-v-0f60ec36> Skip to content </a><!--]--><!----><header class="VPNav" data-v-1f115b32 data-v-7b5052ee><div class="VPNavBar has-sidebar" data-v-7b5052ee data-v-2ef5b13a><div class="container" data-v-2ef5b13a><div class="title" data-v-2ef5b13a><div class="VPNavBarTitle has-sidebar" data-v-2ef5b13a data-v-1168a8e4><a class="title" href="/" data-v-1168a8e4><!--[--><!--]--><!--[--><img class="VPImage logo" src="/image.png" alt data-v-8426fc1a><!--]--><span data-v-1168a8e4>welcome to my blog</span><!--[--><!--]--></a></div></div><div class="content" data-v-2ef5b13a><div class="curtain" data-v-2ef5b13a></div><div class="content-body" data-v-2ef5b13a><!--[--><!--]--><div class="VPNavBarSearch search" data-v-2ef5b13a><!--[--><!----><div id="local-search"><button type="button" class="DocSearch DocSearch-Button" aria-label="Search"><span class="DocSearch-Button-Container"><span class="vp-icon DocSearch-Search-Icon"></span><span class="DocSearch-Button-Placeholder">Search</span></span><span class="DocSearch-Button-Keys"><kbd class="DocSearch-Button-Key"></kbd><kbd class="DocSearch-Button-Key">K</kbd></span></button></div><!--]--></div><nav aria-labelledby="main-nav-aria-label" class="VPNavBarMenu menu" data-v-2ef5b13a data-v-3b707760><span id="main-nav-aria-label" class="visually-hidden" data-v-3b707760>Main Navigation</span><!--[--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/friends.html" tabindex="0" data-v-3b707760 data-v-e56f3d57><!--[--><span data-v-e56f3d57>friends</span><!--]--></a><!--]--><!--[--><div class="VPFlyout VPNavBarMenuGroup active" data-v-3b707760 data-v-3413d851><button type="button" class="button" aria-haspopup="true" aria-expanded="false" data-v-3413d851><span class="text" data-v-3413d851><!----><span data-v-3413d851>Notes</span><svg xmlns="http://www.w3.org/2000/svg" aria-hidden="true" focusable="false" viewbox="0 0 24 24" class="text-icon" data-v-3413d851><path d="M12,16c-0.3,0-0.5-0.1-0.7-0.3l-6-6c-0.4-0.4-0.4-1,0-1.4s1-0.4,1.4,0l5.3,5.3l5.3-5.3c0.4-0.4,1-0.4,1.4,0s0.4,1,0,1.4l-6,6C12.5,15.9,12.3,16,12,16z"></path></svg></span></button><div class="menu" data-v-3413d851><div class="VPMenu" data-v-3413d851 data-v-3171c862><div class="items" data-v-3171c862><!--[--><!--[--><div class="VPMenuGroup" data-v-3171c862 data-v-8cbda59b><p class="title" data-v-8cbda59b>Learning</p><!--[--><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/Learning/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8.html" data-v-eaf58e7f><!--[-->æ•°æ®åº“åˆ†åº“åˆ†è¡¨<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/Learning/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html" data-v-eaf58e7f><!--[-->æ¶ˆæ¯é˜Ÿåˆ—<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/Learning/CAP%E7%90%86%E8%AE%BA.html" data-v-eaf58e7f><!--[-->CAPç†è®º<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/Learning/CDN.html" data-v-eaf58e7f><!--[-->CDN<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/Learning/ES.html" data-v-eaf58e7f><!--[-->ES<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/Learning/Go-base.html" data-v-eaf58e7f><!--[-->Go-base<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/Learning/Raft.html" data-v-eaf58e7f><!--[-->Raft<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link active" href="/Notes/Learning/Redis.html" data-v-eaf58e7f><!--[-->Redis<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/Learning/work-pool%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html" data-v-eaf58e7f><!--[-->work-poolè®¾è®¡æ¨¡å¼<!--]--></a></div></div><!--]--></div><!--]--><!--[--><div class="VPMenuGroup" data-v-3171c862 data-v-8cbda59b><p class="title" data-v-8cbda59b>leetcode</p><!--[--><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/leetcode/3297.%20%E7%BB%9F%E8%AE%A1%E9%87%8D%E6%96%B0%E6%8E%92%E5%88%97%E5%90%8E%E5%8C%85%E5%90%AB%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%95%B0%E7%9B%AE%20I.html" data-v-eaf58e7f><!--[-->3297. ç»Ÿè®¡é‡æ–°æ’åˆ—ååŒ…å«å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²æ•°ç›® I<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/leetcode/%E5%B9%B6%E6%9F%A5%E9%9B%86.html" data-v-eaf58e7f><!--[-->å¹¶æŸ¥é›†<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/leetcode/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84.html" data-v-eaf58e7f><!--[-->å•æºæœ€çŸ­è·¯å¾„<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/leetcode/%E5%A0%86%E6%8E%92%E5%BA%8F.html" data-v-eaf58e7f><!--[-->å †æ’åº<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/leetcode/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F.html" data-v-eaf58e7f><!--[-->å¿«é€Ÿæ’åº<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/leetcode/%E6%9C%80%E5%B0%8F%E4%BB%A3%E4%BB%B7%E9%97%AE%E9%A2%98.html" data-v-eaf58e7f><!--[-->æœ€å°ä»£ä»·é—®é¢˜<!--]--></a></div></div><div class="hasVPMenuGroupItem VPMenuGroupContainer" data-v-8cbda59b><div class="VPMenuLink" data-v-8cbda59b data-v-eaf58e7f><a class="VPLink link" href="/Notes/leetcode/LRU.html" data-v-eaf58e7f><!--[-->LRU<!--]--></a></div></div><!--]--></div><!--]--><!--]--></div><!--[--><!--]--></div></div></div><!--]--><!--[--><a class="VPLink link VPNavBarMenuLink" href="/" tabindex="0" data-v-3b707760 data-v-e56f3d57><!--[--><span data-v-e56f3d57>ğŸ¤¡ å…³äºæˆ‘</span><!--]--></a><!--]--><!--[--><a class="VPLink link vp-external-link-icon VPNavBarMenuLink" href="https://juejin.cn/user/4466629837071787" target="_blank" rel="noreferrer" tabindex="0" data-v-3b707760 data-v-e56f3d57><!--[--><span data-v-e56f3d57>ğŸ˜ æ˜é‡‘</span><!--]--></a><!--]--><!--]--></nav><!----><div class="VPNavBarAppearance appearance" data-v-2ef5b13a data-v-6c893767><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-6c893767 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div><div class="VPSocialLinks VPNavBarSocialLinks social-links" data-v-2ef5b13a data-v-0394ad82 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://gitee.com/chen-yuki238" aria-label="gitee" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-gitee"></span></a><a class="VPSocialLink no-icon" href="https://juejin.cn/user/4466629837071787" aria-label="juejin" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-juejin"></span></a><a class="VPSocialLink no-icon" href="https://github.com/" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div><div class="VPFlyout VPNavBarExtra extra" data-v-2ef5b13a data-v-bb2aa2f0 data-v-cf11d7a2><button type="button" class="button" aria-haspopup="true" aria-expanded="false" aria-label="extra navigation" data-v-cf11d7a2><span class="vpi-more-horizontal icon" data-v-cf11d7a2></span></button><div class="menu" data-v-cf11d7a2><div class="VPMenu" data-v-cf11d7a2 data-v-b98bc113><!----><!--[--><!--[--><!----><div class="group" data-v-bb2aa2f0><div class="item appearance" data-v-bb2aa2f0><p class="label" data-v-bb2aa2f0>Appearance</p><div class="appearance-action" data-v-bb2aa2f0><button class="VPSwitch VPSwitchAppearance" type="button" role="switch" title aria-checked="false" data-v-bb2aa2f0 data-v-5337faa4 data-v-1d5665e3><span class="check" data-v-1d5665e3><span class="icon" data-v-1d5665e3><!--[--><span class="vpi-sun sun" data-v-5337faa4></span><span class="vpi-moon moon" data-v-5337faa4></span><!--]--></span></span></button></div></div></div><div class="group" data-v-bb2aa2f0><div class="item social-links" data-v-bb2aa2f0><div class="VPSocialLinks social-links-list" data-v-bb2aa2f0 data-v-7bc22406><!--[--><a class="VPSocialLink no-icon" href="https://gitee.com/chen-yuki238" aria-label="gitee" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-gitee"></span></a><a class="VPSocialLink no-icon" href="https://juejin.cn/user/4466629837071787" aria-label="juejin" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-juejin"></span></a><a class="VPSocialLink no-icon" href="https://github.com/" aria-label="github" target="_blank" rel="noopener" data-v-7bc22406 data-v-bd121fe5><span class="vpi-social-github"></span></a><!--]--></div></div></div><!--]--><!--]--></div></div></div><!--[--><!--]--><button type="button" class="VPNavBarHamburger hamburger" aria-label="mobile navigation" aria-expanded="false" aria-controls="VPNavScreen" data-v-2ef5b13a data-v-e5dd9c1c><span class="container" data-v-e5dd9c1c><span class="top" data-v-e5dd9c1c></span><span class="middle" data-v-e5dd9c1c></span><span class="bottom" data-v-e5dd9c1c></span></span></button></div></div></div></div><!----></header><div class="VPLocalNav has-sidebar empty" data-v-1f115b32 data-v-a6f0e41e><div class="container" data-v-a6f0e41e><button class="menu" aria-expanded="false" aria-controls="VPSidebarNav" data-v-a6f0e41e><span class="vpi-align-left menu-icon" data-v-a6f0e41e></span><span class="menu-text" data-v-a6f0e41e>Menu</span></button><div class="VPLocalNavOutlineDropdown" style="--vp-vh:0px;" data-v-a6f0e41e data-v-17a5e62e><button data-v-17a5e62e>Return to top</button><!----></div></div></div><aside class="VPSidebar" data-v-1f115b32 data-v-319d5ca6><div class="curtain" data-v-319d5ca6></div><nav class="nav" id="VPSidebarNav" aria-labelledby="sidebar-aria-label" tabindex="-1" data-v-319d5ca6><span class="visually-hidden" id="sidebar-aria-label" data-v-319d5ca6> Sidebar Navigation </span><!--[--><!--]--><!--[--><div class="no-transition group" data-v-c40bc020><section class="VPSidebarItem level-0 collapsible has-active" data-v-c40bc020 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h2 class="text" data-v-b7550ba0>Notes</h2><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b7550ba0><span class="vpi-chevron-right caret-icon" data-v-b7550ba0></span></div></div><div class="items" data-v-b7550ba0><!--[--><section class="VPSidebarItem level-1 collapsible has-active" data-v-b7550ba0 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h3 class="text" data-v-b7550ba0>Learning</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b7550ba0><span class="vpi-chevron-right caret-icon" data-v-b7550ba0></span></div></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%88%86%E5%BA%93%E5%88%86%E8%A1%A8.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>æ•°æ®åº“åˆ†åº“åˆ†è¡¨</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/%E6%B6%88%E6%81%AF%E9%98%9F%E5%88%97.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>æ¶ˆæ¯é˜Ÿåˆ—</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/CAP%E7%90%86%E8%AE%BA.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>CAPç†è®º</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/CDN.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>CDN</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/ES.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>ES</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/Go-base.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Go-base</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/Raft.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Raft</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/Redis.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>Redis</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/Learning/work-pool%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>work-poolè®¾è®¡æ¨¡å¼</p><!--]--></a><!----></div><!----></div><!--]--></div></section><section class="VPSidebarItem level-1 collapsible" data-v-b7550ba0 data-v-b7550ba0><div class="item" role="button" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><h3 class="text" data-v-b7550ba0>leetcode</h3><div class="caret" role="button" aria-label="toggle section" tabindex="0" data-v-b7550ba0><span class="vpi-chevron-right caret-icon" data-v-b7550ba0></span></div></div><div class="items" data-v-b7550ba0><!--[--><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/leetcode/3297.%20%E7%BB%9F%E8%AE%A1%E9%87%8D%E6%96%B0%E6%8E%92%E5%88%97%E5%90%8E%E5%8C%85%E5%90%AB%E5%8F%A6%E4%B8%80%E4%B8%AA%E5%AD%97%E7%AC%A6%E4%B8%B2%E7%9A%84%E5%AD%90%E5%AD%97%E7%AC%A6%E4%B8%B2%E6%95%B0%E7%9B%AE%20I.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>3297. ç»Ÿè®¡é‡æ–°æ’åˆ—ååŒ…å«å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²æ•°ç›® I</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/leetcode/%E5%B9%B6%E6%9F%A5%E9%9B%86.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>å¹¶æŸ¥é›†</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/leetcode/%E5%8D%95%E6%BA%90%E6%9C%80%E7%9F%AD%E8%B7%AF%E5%BE%84.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>å•æºæœ€çŸ­è·¯å¾„</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/leetcode/%E5%A0%86%E6%8E%92%E5%BA%8F.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>å †æ’åº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/leetcode/%E5%BF%AB%E9%80%9F%E6%8E%92%E5%BA%8F.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>å¿«é€Ÿæ’åº</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/leetcode/%E6%9C%80%E5%B0%8F%E4%BB%A3%E4%BB%B7%E9%97%AE%E9%A2%98.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>æœ€å°ä»£ä»·é—®é¢˜</p><!--]--></a><!----></div><!----></div><div class="VPSidebarItem level-2 is-link" data-v-b7550ba0 data-v-b7550ba0><div class="item" tabindex="0" data-v-b7550ba0><div class="indicator" data-v-b7550ba0></div><a class="VPLink link link" href="/Notes/leetcode/LRU.html" data-v-b7550ba0><!--[--><p class="text" data-v-b7550ba0>LRU</p><!--]--></a><!----></div><!----></div><!--]--></div></section><!--]--></div></section></div><!--]--><!--[--><!--]--></nav></aside><div class="VPContent has-sidebar" id="VPContent" data-v-1f115b32 data-v-3d29b473><div class="VPDoc has-sidebar has-aside" data-v-3d29b473 data-v-39a288b8><!--[--><!--]--><div class="container" data-v-39a288b8><div class="aside" data-v-39a288b8><div class="aside-curtain" data-v-39a288b8></div><div class="aside-container" data-v-39a288b8><div class="aside-content" data-v-39a288b8><div class="VPDocAside" data-v-39a288b8 data-v-3f215769><!--[--><!--]--><!--[--><!--]--><nav aria-labelledby="doc-outline-aria-label" class="VPDocAsideOutline" data-v-3f215769 data-v-a5bbad30><div class="content" data-v-a5bbad30><div class="outline-marker" data-v-a5bbad30></div><div aria-level="2" class="outline-title" id="doc-outline-aria-label" role="heading" data-v-a5bbad30>å¯¼èˆªæ </div><ul class="VPDocOutlineItem root" data-v-a5bbad30 data-v-b933a997><!--[--><!--]--></ul></div></nav><!--[--><!--]--><div class="spacer" data-v-3f215769></div><!--[--><!--]--><!----><!--[--><!--]--><!--[--><!--]--></div></div></div></div><div class="content" data-v-39a288b8><div class="content-container" data-v-39a288b8><!--[--><!--]--><main class="main" data-v-39a288b8><div style="position:relative;" class="vp-doc _Notes_Learning_Redis" data-v-39a288b8><div><h1 id="redis" tabindex="-1">Redis <a class="header-anchor" href="#redis" aria-label="Permalink to &quot;Redis&quot;">â€‹</a></h1><h2 id="redisçš„åŸºæœ¬å·¥ä½œåŸç†" tabindex="-1">Redisçš„åŸºæœ¬å·¥ä½œåŸç† <a class="header-anchor" href="#redisçš„åŸºæœ¬å·¥ä½œåŸç†" aria-label="Permalink to &quot;Redisçš„åŸºæœ¬å·¥ä½œåŸç†&quot;">â€‹</a></h2><p>Redisï¼ˆRemote Dictionary Serverï¼Œè¿œç¨‹å­—å…¸æœåŠ¡ï¼‰æ˜¯ä¸€ä¸ªå¼€æºçš„ã€é«˜æ€§èƒ½çš„é”®å€¼å­˜å‚¨æ•°æ®åº“ï¼Œå¸¸ç”¨äºç¼“å­˜ã€æ¶ˆæ¯é˜Ÿåˆ—å’Œæ•°æ®å­˜å‚¨ç­‰åœºæ™¯ã€‚</p><p>Redisçš„æ•°æ®ä»å†…å­˜è¯»å–ï¼Œå¢é‡æ•°æ®ä¿å­˜åˆ°AOFæ–‡ä»¶ï¼Œå…¨é‡æ•°æ®ä¿å­˜åˆ°RDBæ–‡ä»¶ã€‚åœ¨è¯»å†™å†…å­˜æ—¶ï¼Œä¼šæŠŠå†™å‘½ä»¤è¿½åŠ åˆ°AOFæ–‡ä»¶ï¼ŒRDBæ–‡ä»¶ä¿å­˜Redisä¸­æ‰€æœ‰çš„æ•°æ®ã€‚å½“Rediså¯åŠ¨æ—¶ï¼Œæ ¹æ®RDBæ–‡ä»¶æ¢å¤æ•°æ®åˆ°å†…å­˜ï¼Œå†æ ¹æ®AOFæ–‡ä»¶æŠŠæœ«å°¾å‡ æ¡æœªå†™å…¥RDBçš„æ—¥å¿—æ¢å¤æ•°æ®ã€‚</p><h2 id="redisæ¡ˆä¾‹åº”ç”¨" tabindex="-1">Redisæ¡ˆä¾‹åº”ç”¨ <a class="header-anchor" href="#redisæ¡ˆä¾‹åº”ç”¨" aria-label="Permalink to &quot;Redisæ¡ˆä¾‹åº”ç”¨&quot;">â€‹</a></h2><h3 id="è¿ç»­ç­¾åˆ°-string" tabindex="-1">è¿ç»­ç­¾åˆ°ï¼ˆStringï¼‰ <a class="header-anchor" href="#è¿ç»­ç­¾åˆ°-string" aria-label="Permalink to &quot;è¿ç»­ç­¾åˆ°ï¼ˆStringï¼‰&quot;">â€‹</a></h3><p>1.ç­¾åˆ°ä¹‹åç­¾åˆ°å¤©æ•°åŠ ä¸€ 2.è¿ç»­ï¼ˆ0ç‚¹ä¹‹å‰ç­¾åˆ°ï¼Œå¦åˆ™å½’é›¶ï¼‰</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// addContinuesDays ä¸ºç”¨æˆ·ç­¾åˆ°ç»­æœŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> addContinuesDays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sprintf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(continuesCheckKey, userID)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// 1. è¿ç»­ç­¾åˆ°æ•°+1</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Incr</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, key).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Errorf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ç”¨æˆ·[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]è¿ç»­ç­¾åˆ°å¤±è´¥&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, userID)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		expAt </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> beginningOfDay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Add</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">48</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.Hour)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		// 2. è®¾ç½®ç­¾åˆ°è®°å½•åœ¨åå¤©çš„0ç‚¹åˆ°æœŸ</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ExpireAt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, key, expAt).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">			// 3. æ‰“å°ç”¨æˆ·ç»­ç­¾åçš„è¿ç»­ç­¾åˆ°å¤©æ•°</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			day, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getUserCheckInDays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">				panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ç”¨æˆ·[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]è¿ç»­ç­¾åˆ°ï¼š</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">(å¤©), è¿‡æœŸæ—¶é—´:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, userID, day, expAt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Format</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2006-01-02 15:04:05&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// getUserCheckInDays è·å–ç”¨æˆ·è¿ç»­ç­¾åˆ°å¤©æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> getUserCheckInDays</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) (</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">error</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sprintf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(continuesCheckKey, userID)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	days, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Get</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, key).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, err</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> daysInt, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(days, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">); err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	} </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">else</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> daysInt, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">nil</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// beginningOfDay è·å–ä»Šå¤©0ç‚¹æ—¶é—´</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> beginningOfDay</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">() </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Time</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	now </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	y, m, d </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> now.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Date</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(y, m, d, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, time.Local)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ç”¨åˆ°çš„æ•°æ®ç»“æ„:String</p><p>String æ˜¯ Redis ä¸­æœ€åŸºæœ¬çš„æ•°æ®ç±»å‹ï¼Œå¯ä»¥å­˜å‚¨ä»»æ„ç±»å‹çš„æ•°æ®ï¼Œå¦‚æ–‡æœ¬ã€æ•°å­—ã€å›¾ç‰‡æˆ–åºåˆ—åŒ–çš„å¯¹è±¡ç­‰ã€‚ä¸€ä¸ª String ç±»å‹çš„é”®æœ€å¤§å¯ä»¥å­˜å‚¨ 512MB çš„æ•°æ®</p><p>Redis çš„ String ç±»å‹åº•å±‚å®ç°æ˜¯ SDSï¼ˆSimple Dynamic Stringï¼Œç®€å•åŠ¨æ€å­—ç¬¦ä¸²ï¼‰ã€‚SDS ç”±é•¿åº¦ã€ç©ºé—²ç©ºé—´å’Œå­—èŠ‚æ•°ç»„ä¸‰éƒ¨åˆ†ç»„æˆ</p><p>åº”ç”¨åœºæ™¯ï¼šå­˜å‚¨è®¡æ•°ï¼ŒSession</p><h3 id="æ¶ˆæ¯é€šçŸ¥-list" tabindex="-1">æ¶ˆæ¯é€šçŸ¥ï¼ˆListï¼‰ <a class="header-anchor" href="#æ¶ˆæ¯é€šçŸ¥-list" aria-label="Permalink to &quot;æ¶ˆæ¯é€šçŸ¥ï¼ˆListï¼‰&quot;">â€‹</a></h3><p>ç”¨Listä½œä¸ºæ¶ˆæ¯é˜Ÿåˆ—ï¼Œä¾‹å¦‚å½“æ–‡ç« æ›´æ–°æ—¶ï¼Œå°†æ›´æ–°åçš„æ–‡ç« æ¨é€åˆ°ESï¼Œç”¨æˆ·å°±èƒ½æœç´¢åˆ°æœ€æ–°çš„æ–‡ç« æ•°æ®ã€‚</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">package</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> example</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fmt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">strings</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">gitee.com/wedone/redis_course/example/common</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> ex04ListenList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ex04_list_0&quot;</span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;"> // lpush ex04_list_0 AA BB</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Ex04Params Ex04çš„è‡ªå®šä¹‰å‡½æ•°</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ex04Params</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ex04</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	eventLogger </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> &amp;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">common</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ConcurrentEventLogger</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// newä¸€ä¸ªå¹¶å‘æ‰§è¡Œå™¨</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// routineNumsæ˜¯æ¶ˆè´¹ç«¯çš„æ•°é‡ï¼Œå¤šæ¶ˆè´¹çš„åœºæ™¯ï¼Œå¯ä»¥ä½¿ç”¨ex04ConsumerPopï¼Œä½¿ç”¨ex04ConsumerRangeå­˜åœ¨æ¶ˆæ¯é‡å¤æ¶ˆè´¹çš„é—®é¢˜ã€‚</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	cInst </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> common.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">NewConcurrentRoutine</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, eventLogger)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// å¹¶å‘æ‰§è¡Œç”¨æˆ·è‡ªå®šä¹‰å‡½æ•°work</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	cInst.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Run</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Ex04Params</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{}, ex04ConsumerPop)</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// æŒ‰æ—¥å¿—æ—¶é—´æ­£åºæ‰“å°æ—¥å¿—</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	eventLogger.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">PrintLogs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ex04ConsumerPop ä½¿ç”¨rpopé€æ¡æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„ä¿¡æ¯ï¼Œæ•°æ®ä»é˜Ÿåˆ—ä¸­ç§»é™¤</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç”Ÿæˆç«¯ä½¿ç”¨ï¼šlpush ex04_list_0 AA BB</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ex04ConsumerPop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cInstParam</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> common</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CInstParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	routine </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cInstParam.Routine</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		items, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">BRPop</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, ex04ListenList).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(common.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LogFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(routine, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;è¯»å–æ–‡ç« [</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">]æ ‡é¢˜ã€æ­£æ–‡ï¼Œå‘é€åˆ°ESæ›´æ–°ç´¢å¼•&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, items[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		// å°†æ–‡ç« å†…å®¹æ¨é€åˆ°ES</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sleep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.Second)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ex04ConsumerRange ä½¿ç”¨lrangeæ‰¹é‡æ¶ˆè´¹é˜Ÿåˆ—ä¸­çš„æ•°æ®ï¼Œæ•°æ®ä¿ç•™åœ¨é˜Ÿåˆ—ä¸­</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ç”Ÿæˆç«¯ä½¿ç”¨ï¼šrpush ex04_list_0 AA BB</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¶ˆè´¹ç«¯ï¼š</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ–¹æ³•1 lrange ex04_list_0 -3 -1 // ä»FIFOé˜Ÿå°¾ä¸­ä¸€æ¬¡æ¶ˆè´¹3æ¡ä¿¡æ¯</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ–¹æ³•2 rpop ex04_list_0 3</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> ex04ConsumerRange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">cInstParam</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> common</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">CInstParams</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	routine </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cInstParam.Routine</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	consumeBatchSize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ä¸€æ¬¡å–Nä¸ªæ¶ˆæ¯</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">		// ä»index(-consumeBatchSize)å¼€å§‹å–ï¼Œç›´åˆ°æœ€åä¸€ä¸ªå…ƒç´ index(-1)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		items, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LRange</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, ex04ListenList, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">consumeBatchSize, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(items) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(common.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">LogFormat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(routine, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;æ”¶åˆ°ä¿¡æ¯:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, strings.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Join</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(items, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-&gt;&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)))</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">			// æ¸…é™¤å·²æ¶ˆè´¹çš„é˜Ÿåˆ—</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">			// æ–¹æ³•1 ä½¿ç”¨LTrim</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">			// ä¿ç•™ä»index(0)å¼€å§‹åˆ°index(-(consumeBatchSize + 1))çš„éƒ¨åˆ†ï¼Œå³ä¸ºæœªæ¶ˆè´¹çš„éƒ¨åˆ†</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">			// RedisClient.LTrim(ctx, ex04ListenList, 0, -(consumeBatchSize + 1))</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">			// æ–¹æ³•2 ä½¿ç”¨RPop</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">RPopCount</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, ex04ListenList, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(consumeBatchSize))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sleep</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">3</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> *</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> time.Second)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>QuickListç”±åŒå‘é“¾è¡¨å’Œlistpackå®ç°ï¼ŒRedisä¸ºäº†å‹ç¼©å†…å­˜ï¼ŒæŠŠå¤šä¸ªæ•°æ®å­˜åˆ°ä¸€ä¸ªèŠ‚ç‚¹é‡Œï¼Œä¹Ÿå°±æ˜¯listpackã€‚listpackå¤´éƒ¨ä¼šæ”¾é•¿åº¦ä»¥åŠå…ƒç´ ä¸ªæ•°ï¼Œæ¯ä¸ªå…ƒç´ å çš„é•¿åº¦ä¸€æ ·é•¿ã€‚</p><h3 id="è®¡æ•°-hash" tabindex="-1">è®¡æ•°ï¼ˆHashï¼‰ <a class="header-anchor" href="#è®¡æ•°-hash" aria-label="Permalink to &quot;è®¡æ•°ï¼ˆHashï¼‰&quot;">â€‹</a></h3><p>å½“æœ‰å¤šé¡¹è®¡æ•°éœ€æ±‚æ—¶ï¼Œå¯ä»¥ç”¨Hashæ•°æ®ç»“æ„ã€‚</p><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Ex05UserCountKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ex05_user_count&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ex05</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">==</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;args can NOT be empty</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		os.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Exit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	arg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	switch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg1 {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;init&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		Ex06InitUserCounter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;get&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		userID, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		GetUserCounter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;incr_like&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		userID, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		IncrByUserLike</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;incr_collect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		userID, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		IncrByUserCollect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;decr_like&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		userID, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		DecrByUserLike</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;decr_collect&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		userID, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		DecrByUserCollect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ex06InitUserCounter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	pipe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	userCounters </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">map</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">[</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">interface</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{}{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1556564194374926&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;got_digg_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10693</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;got_view_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2238438</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;followee_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">176</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;follower_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">9895</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;follow_collect_set_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;subscribe_tag_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">95</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;1111&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;got_digg_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">19</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;got_view_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">4</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		{</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;2222&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;got_digg_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1238</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;follower_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">379</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _, counter </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> userCounters {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		uid, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(counter[</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">].(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">), </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		key </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetUserCounterKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(uid)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		rw, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pipe.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Del</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, key).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;del </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, rw=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, key, rw)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		_, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pipe.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HMSet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, key, counter).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;è®¾ç½® uid=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, key=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, uid, key)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// æ‰¹é‡æ‰§è¡Œä¸Šé¢forå¾ªç¯è®¾ç½®å¥½çš„hmsetå‘½ä»¤</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	_, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pipe.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Exec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> { </span><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æŠ¥é”™åè¿›è¡Œä¸€æ¬¡é¢å¤–å°è¯•</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		_, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pipe.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Exec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetUserCounterKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Sprintf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">_</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Ex05UserCountKey, userID)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetUserCounter</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	pipe </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Pipeline</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	GetUserCounterKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userID)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	pipe.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HGetAll</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, </span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">GetUserCounterKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userID))</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	cmders, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> pipe.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Exec</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> _, cmder </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmders {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		counterMap, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> cmder.(</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">MapStringStringCmd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> field, value </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> counterMap {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, field, value)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// IncrByUserLike ç‚¹èµæ•°+1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IncrByUserLike</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	incrByUserField</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;got_digg_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// IncrByUserCollect æ”¶è—æ•°+1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> IncrByUserCollect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	incrByUserField</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;follow_collect_set_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// DecrByUserLike ç‚¹èµæ•°-1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DecrByUserLike</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	decrByUserField</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;got_digg_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// DecrByUserCollect æ”¶è—æ•°-1</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> DecrByUserCollect</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	decrByUserField</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID, </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;follow_collect_set_count&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> incrByUserField</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">field</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	change</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID, field, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> decrByUserField</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">field</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">	change</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, userID, field, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> change</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">userID</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">field</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">incr</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	redisKey </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetUserCounterKey</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(userID)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	before, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HGet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, redisKey, field).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	beforeInt, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(before, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> beforeInt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">incr </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ç¦æ­¢å˜æ›´è®¡æ•°ï¼Œè®¡æ•°å˜æ›´åå°äº0. </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> + (</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">) = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, beforeInt, incr, beforeInt</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">incr)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">æ›´æ–°å‰</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">--------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, userID, field, before)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	_, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HIncrBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, redisKey, field, incr).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// fmt.Printf(&quot;æ›´æ–°è®°å½•[%d]:%d\n&quot;, userID, num)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	count, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">HGet</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, redisKey, field).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user_id: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">æ›´æ–°å</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> = </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">--------</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, userID, field, count)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><p>ä½¿ç”¨Hashå°±å¥½æ¯”ç‚¹å¤–å–ï¼ŒæŠŠä¸€é¡¿é¥­ç›´æ¥æ‰“åŒ…è¿‡æ¥ï¼Œè€Œä¸æ˜¯ä¸€é“èœä¸€é“èœé€è¿‡æ¥ã€‚</p><h4 id="redisä¸­çš„rehashæœºåˆ¶" tabindex="-1">Redisä¸­çš„rehashæœºåˆ¶ <a class="header-anchor" href="#redisä¸­çš„rehashæœºåˆ¶" aria-label="Permalink to &quot;Redisä¸­çš„rehashæœºåˆ¶&quot;">â€‹</a></h4><ol><li>å“ˆå¸Œè¡¨ç»“æ„</li></ol><p>Redisçš„å­—å…¸ï¼ˆ<code>dict</code>ï¼‰ä½¿ç”¨å“ˆå¸Œè¡¨ï¼ˆ<code>dictht</code>ï¼‰ä½œä¸ºå…¶åŸºæœ¬å­˜å‚¨ç»“æ„ã€‚æ¯ä¸ªå­—å…¸åŒ…å«ä¸¤ä¸ªå“ˆå¸Œè¡¨ï¼Œç”¨äºå®ç°æ¸è¿›å¼rehashã€‚å“ˆå¸Œè¡¨çš„ç»“æ„å®šä¹‰å¦‚ä¸‹ï¼š</p><ul><li><strong>å•ä¸ªèŠ‚ç‚¹</strong>ï¼š<code>dictEntry</code>ï¼ŒåŒ…å«é”®ï¼ˆ<code>key</code>ï¼‰ã€å€¼ï¼ˆ<code>v</code>ï¼‰å’ŒæŒ‡å‘ä¸‹ä¸€ä¸ªå“ˆå¸Œè¡¨èŠ‚ç‚¹çš„æŒ‡é’ˆï¼ˆ<code>next</code>ï¼‰ã€‚</li><li><strong>å“ˆå¸Œè¡¨</strong>ï¼š<code>dictht</code>ï¼ŒåŒ…å«å“ˆå¸Œè¡¨æ•°ç»„ï¼ˆ<code>table</code>ï¼‰ã€å“ˆå¸Œè¡¨å¤§å°ï¼ˆ<code>size</code>ï¼‰ã€å¤§å°æ©ç ï¼ˆ<code>sizemask</code>ï¼‰å’Œå·²ä½¿ç”¨çš„èŠ‚ç‚¹æ•°ï¼ˆ<code>used</code>ï¼‰ã€‚</li><li><strong>å­—å…¸ç»“æ„ä½“</strong>ï¼š<code>dict</code>ï¼ŒåŒ…å«ä¸¤ä¸ªå“ˆå¸Œè¡¨ï¼ˆ<code>ht[0]</code>å’Œ<code>ht[1]</code>ï¼‰ã€ç±»å‹ç‰¹å®šå‡½æ•°ï¼ˆ<code>type</code>ï¼‰ã€ç§æœ‰æ•°æ®ï¼ˆ<code>privdata</code>ï¼‰ã€rehashç´¢å¼•ï¼ˆ<code>rehashidx</code>ï¼‰å’Œè¿­ä»£å™¨æ•°é‡ï¼ˆ<code>iterators</code>ï¼‰ã€‚</li></ul><ol start="2"><li>æ¸è¿›å¼å“ˆå¸Œæ‰©å®¹ï¼ˆrehashï¼‰</li></ol><p>Redisé‡‡ç”¨æ¸è¿›å¼rehashæœºåˆ¶ï¼Œé¿å…ä¸€æ¬¡æ€§å®Œæˆrehashæ“ä½œå¯¼è‡´çš„æ€§èƒ½ç“¶é¢ˆã€‚å…·ä½“è¿‡ç¨‹å¦‚ä¸‹ï¼š</p><ol><li><p><strong>åˆå§‹åŒ–rehash</strong>ï¼š</p><ul><li><code>rehashidx</code> è¢«è®¾ç½®ä¸º <code>0</code>ï¼Œè¡¨ç¤ºrehashå¼€å§‹ã€‚</li><li>ä¸º <code>ht[1]</code> åˆ†é…æ–°çš„ç©ºé—´ï¼Œå¤§å°é€šå¸¸æ˜¯ <code>ht[0]</code> çš„ä¸¤å€ã€‚</li></ul></li><li><p><strong>é€æ­¥è¿ç§»</strong>ï¼š</p><ul><li>æ¯æ¬¡æ‰§è¡Œå“ˆå¸Œè¡¨æ“ä½œï¼ˆå¦‚ <code>SET</code>ã€<code>GET</code>ã€<code>DEL</code> ç­‰ï¼‰æ—¶ï¼ŒRedisä¼šæ£€æŸ¥å½“å‰æ˜¯å¦æœ‰éœ€è¦è¿ç§»çš„å…ƒç´ ã€‚</li><li>å¦‚æœæœ‰è¿ç§»ä»»åŠ¡ï¼ŒRedisä¼šå°†ä¸€éƒ¨åˆ†å…ƒç´ ä» <code>ht[0]</code> è¿ç§»åˆ° <code>ht[1]</code>ï¼Œå¹¶æ›´æ–° <code>rehashidx</code>ã€‚</li><li>è¿ç§»è¿‡ç¨‹ä¸­ï¼Œ<code>ht[0]</code> å’Œ <code>ht[1]</code> åŒæ—¶å­˜åœ¨ï¼Œç›´åˆ°æ‰€æœ‰å…ƒç´ è¿ç§»å®Œæˆã€‚</li></ul></li><li><p><strong>å®Œæˆrehash</strong>ï¼š</p><ul><li>å½“æ‰€æœ‰å…ƒç´ è¿ç§»åˆ° <code>ht[1]</code> åï¼Œ<code>ht[0]</code> è¢«é‡Šæ”¾ï¼Œ<code>ht[1]</code> æˆä¸ºæ–°çš„å“ˆå¸Œè¡¨ã€‚</li><li><code>rehashidx</code> è¢«è®¾ç½®ä¸º <code>-1</code>ï¼Œè¡¨ç¤ºrehashå®Œæˆã€‚</li></ul></li><li><p>æ‰©å®¹æ¡ä»¶</p></li></ol><p>Rediså­—å…¸çš„æ‰©å®¹å‘ç”Ÿåœ¨ä»¥ä¸‹æ¡ä»¶ä¸‹ï¼š</p><ul><li><strong>è´Ÿè½½å› å­</strong> è¶…è¿‡è®¾å®šé˜ˆå€¼ï¼ˆé»˜è®¤ä¸º1ï¼‰ï¼Œå³å­—å…¸ä¸­çš„å…ƒç´ æ•°é‡è¶…è¿‡äº†å­—å…¸å®¹é‡çš„è´Ÿè½½å› å­ã€‚</li><li>Redisä¼šå°†å“ˆå¸Œè¡¨çš„å®¹é‡æ‰©å¤§ä¸ºåŸæ¥çš„2å€ï¼Œä»¥é™ä½è´Ÿè½½å› å­ï¼Œæé«˜æŸ¥æ‰¾æ•ˆç‡ã€‚</li></ul><p><strong>ä¸ºä»€ä¹ˆéœ€è¦rehashï¼Ÿ</strong></p><p>å½“å“ˆå¸Œè¡¨ä¸­çš„å…ƒç´ æ•°é‡å¢åŠ åˆ°ä¸€å®šç¨‹åº¦æ—¶ï¼Œå“ˆå¸Œè¡¨çš„è´Ÿè½½å› å­ï¼ˆload factorï¼‰ä¼šè¶…è¿‡ä¸€ä¸ªé¢„è®¾çš„é˜ˆå€¼ï¼ˆé»˜è®¤ä¸º1ï¼‰ã€‚è´Ÿè½½å› å­æ˜¯å“ˆå¸Œè¡¨ä¸­å·²ä½¿ç”¨çš„æ§½ä½æ•°ä¸æ€»æ§½ä½æ•°çš„æ¯”å€¼ã€‚å½“è´Ÿè½½å› å­è¿‡é«˜æ—¶ï¼Œå“ˆå¸Œå†²çªçš„æ¦‚ç‡ä¼šæ˜¾è‘—å¢åŠ ï¼Œå¯¼è‡´æŸ¥æ‰¾æ€§èƒ½ä¸‹é™ã€‚ä¸ºäº†ç»´æŒå“ˆå¸Œè¡¨çš„é«˜æ•ˆæ€§èƒ½ï¼ŒRedisä¼šè§¦å‘<code>rehash</code>æ“ä½œï¼Œå°†å“ˆå¸Œè¡¨çš„å¤§å°æ‰©å¤§ä¸ºåŸæ¥çš„ä¸¤å€ã€‚è¿™æ ·å¯ä»¥é™ä½è´Ÿè½½å› å­ï¼Œå‡å°‘å“ˆå¸Œå†²çªï¼Œæé«˜æŸ¥æ‰¾æ•ˆç‡</p><p>å› ä¸ºä¸èƒ½åœ¨è¿ç§»æ•°æ®æ—¶é˜»å¡ç”¨æˆ·è¯»å–æ•°æ®ï¼Œæ‰€ä»¥å°±æ¯æ¬¡è®¿é—®é¡ºä¾¿è¿ç§»ä¸€ç‚¹æ•°æ®ï¼ŒæŠŠè¿ç§»å¹³æ‘Šåˆ°æ¯ä¸€æ¬¡çš„ç”¨æˆ·è®¿é—®</p><h3 id="æ’è¡Œæ¦œ-zset" tabindex="-1">æ’è¡Œæ¦œï¼ˆZSetï¼‰ <a class="header-anchor" href="#æ’è¡Œæ¦œ-zset" aria-label="Permalink to &quot;æ’è¡Œæ¦œï¼ˆZSetï¼‰&quot;">â€‹</a></h3><div class="language-go vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">go</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">package</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> example</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">import</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> (</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">context</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">fmt</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">strconv</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">time</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">	&quot;</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">github.com/go-redis/redis/v9</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">const</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> Ex06RankKey</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> =</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;ex06_rank_zset&quot;</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">type</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ex06ItemScore</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> struct</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	ItemNam </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	Score   </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">float64</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// Ex06 æ’è¡Œæ¦œ</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// go run main.go init // åˆå§‹åŒ–ç§¯åˆ†</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// go run main.go Ex06 rev_order // è¾“å‡ºå®Œæ•´æ¦œå•</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// go run main.go  Ex06 order_page 0 // é€†åºåˆ†é¡µè¾“å‡ºï¼Œoffset=1</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// go run main.go  Ex06 get_rank user2 // è·å–user2çš„æ’å</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// go run main.go  Ex06 get_score user2 // è·å–user2çš„åˆ†æ•°</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// go run main.go  Ex06 add_user_score user2 10 // ä¸ºuser2è®¾ç½®ä¸º10åˆ†</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// zadd ex06_rank_zset 15 andy</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// zincrby ex06_rank_zset -9 andy // andy æ‰£9åˆ†ï¼Œæ’åæ‰åˆ°æœ€åä¸€å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ex06</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">args</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	arg1 </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	switch</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> arg1 {</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;init&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		Ex06InitUserScore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;rev_order&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		GetRevOrderAllList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;order_page&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		pageSize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">]) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&gt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			offset, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseInt</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">				panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			GetOrderListByPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, offset, pageSize)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;get_rank&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		GetUserRankByName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;get_score&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		GetUserScoreByName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">])</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	case</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;"> &quot;add_user_score&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">:</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> len</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args) </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">&lt;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 3</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">			fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;å‚æ•°é”™è¯¯ï¼Œå¯èƒ½æ˜¯ç¼ºå°‘éœ€è¦å¢åŠ çš„åˆ†å€¼ã€‚egï¼šgo run main.go  Ex06 add_user_score user2 10</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">			return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		score, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> strconv.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ParseFloat</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">2</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">			panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		}</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		AddUserScore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, args[</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">], score)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> Ex06InitUserScore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	initList </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> []</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">redis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Z</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		{Member: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user1&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Score: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">10</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, {Member: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user2&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Score: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">232</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}, {Member: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user3&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Score: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">129</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		{Member: </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;user4&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, Score: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">232</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">},</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// æ¸…ç©ºæ¦œå•</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Del</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, Ex06RankKey).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Err</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(); err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	nums, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ZAdd</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, Ex06RankKey, initList</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">...</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;åˆå§‹åŒ–æ¦œå•Itemæ•°é‡:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, nums)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ¦œå•é€†åºè¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ZRANGE ex06_rank_zset +inf -inf BYSCORE  rev WITHSCORES</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// æ­£åºè¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// ZRANGE ex06_rank_zset 0 -1 WITHSCORES</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetRevOrderAllList</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">limit</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">offset</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	resList, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ZRevRangeWithScores</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, Ex06RankKey, </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">0</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">-</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">æ¦œå•:</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i, z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> resList {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ç¬¬</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">å </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s\t%f\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, i</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, z.Member, z.Score)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetOrderListByPage</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">offset</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">pageSize</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// zrange ex06_rank_zset 300 0 byscore rev limit 1 2 withscores // å–300åˆ†åˆ°0åˆ†ä¹‹é—´çš„æ’å</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// zrange ex06_rank_zset -inf +inf byscore withscores æ­£åºè¾“å‡º</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// ZRANGE ex06_rank_zset +inf -inf BYSCORE  REV WITHSCORES é€†åºè¾“å‡ºæ‰€æœ‰æ’å</span></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">	// zrange ex06_rank_zset +inf -inf byscore rev limit 0 2 withscores é€†åºåˆ†é¡µè¾“å‡ºæ’å</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	zRangeArgs </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> redis</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ZRangeArgs</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">{</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		Key:     Ex06RankKey,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		ByScore: </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		Rev:     </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">true</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		Start:   </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;-inf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		Stop:    </span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;+inf&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		Offset:  offset,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		Count:   pageSize,</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	resList, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ZRangeArgsWithScores</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, zRangeArgs).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">æ¦œå•(offest=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, pageSize=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">):</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, offset, pageSize)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	offNum </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> int</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(pageSize </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">*</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offset)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	for</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i, z </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> range</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> resList {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		rank </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> i </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> 1</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> +</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> offNum</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;ç¬¬</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">å </span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s\t%f\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, rank, z.Member, z.Score)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// GetUserRankByName è·å–ç”¨æˆ·æ’å</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetUserRankByName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	rank, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ZRevRank</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, Ex06RankKey, name).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Errorf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error getting name=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, err=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name, err)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;name=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, æ’å=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%d\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name, rank</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">+</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">1</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// GetUserScoreByName è·å–ç”¨æˆ·åˆ†å€¼</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> GetUserScoreByName</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	score, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ZScore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, Ex06RankKey, name).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">		fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Errorf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;error getting name=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, err=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%v</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name, err)</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">		return</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Println</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(time.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Now</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">().</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">UnixMilli</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">())</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;name=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, åˆ†æ•°=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%f\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name, score)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span>
<span class="line"></span>
<span class="line"><span style="--shiki-light:#6A737D;--shiki-dark:#6A737D;">// AddUserScore æ’åç”¨æˆ·</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">func</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> AddUserScore</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">ctx</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;"> context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Context</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">name</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> string</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, </span><span style="--shiki-light:#E36209;--shiki-dark:#FFAB70;">score</span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;"> float64</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">) {</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	num, err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">:=</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> RedisClient.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">ZIncrBy</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(ctx, Ex06RankKey, score, name).</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Result</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">()</span></span>
<span class="line"><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">	if</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> err </span><span style="--shiki-light:#D73A49;--shiki-dark:#F97583;">!=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;"> nil</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;"> {</span></span>
<span class="line"><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">		panic</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(err)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	}</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">	fmt.</span><span style="--shiki-light:#6F42C1;--shiki-dark:#B392F0;">Printf</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">(</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;name=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%s</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, add_score=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%f</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">, score=</span><span style="--shiki-light:#005CC5;--shiki-dark:#79B8FF;">%f\n</span><span style="--shiki-light:#032F62;--shiki-dark:#9ECBFF;">&quot;</span><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">, name, score, num)</span></span>
<span class="line"><span style="--shiki-light:#24292E;--shiki-dark:#E1E4E8;">}</span></span></code></pre></div><h4 id="redisçš„zsetæ•°æ®ç»“æ„" tabindex="-1">Redisçš„ZSetæ•°æ®ç»“æ„ <a class="header-anchor" href="#redisçš„zsetæ•°æ®ç»“æ„" aria-label="Permalink to &quot;Redisçš„ZSetæ•°æ®ç»“æ„&quot;">â€‹</a></h4><p>ZSetï¼ˆæœ‰åºé›†åˆï¼‰æ˜¯Redisä¸­çš„ä¸€ç§æ•°æ®ç»“æ„ï¼Œå®ƒç»“åˆäº†é›†åˆå’Œæœ‰åºçš„ç‰¹ç‚¹ã€‚ZSetä¸­çš„æ¯ä¸ªæˆå‘˜éƒ½å…³è”ä¸€ä¸ªåˆ†æ•°ï¼ˆscoreï¼‰ï¼ŒRedisä¼šæ ¹æ®åˆ†æ•°å¯¹æˆå‘˜è¿›è¡Œæ’åºã€‚ZSetä¸­çš„æˆå‘˜æ˜¯å”¯ä¸€çš„ï¼Œä½†åˆ†æ•°å¯ä»¥é‡å¤ã€‚ZSetéå¸¸é€‚åˆç”¨äºå®ç°æ’è¡Œæ¦œã€å®æ—¶åˆ†æç­‰åŠŸèƒ½ã€‚</p><p>ZSetçš„åº•å±‚å®ç°ä½¿ç”¨äº†ä¸¤ä¸ªæ•°æ®ç»“æ„ï¼š</p><ol><li><strong>è·³è¡¨ï¼ˆSkip Listï¼‰</strong>ï¼š <ul><li>è·³è¡¨æ˜¯ä¸€ç§æœ‰åºçš„æ•°æ®ç»“æ„ï¼Œæ”¯æŒå¿«é€Ÿçš„æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æ“ä½œã€‚ZSetä¸­çš„æˆå‘˜æŒ‰ç…§åˆ†æ•°çš„å¤§å°å­˜å‚¨åœ¨è·³è¡¨ä¸­ï¼Œæ”¯æŒèŒƒå›´æŸ¥è¯¢å’Œæ’åºã€‚</li></ul></li><li><strong>å“ˆå¸Œè¡¨ï¼ˆHash Tableï¼‰</strong>ï¼š <ul><li>å“ˆå¸Œè¡¨ç”¨äºå­˜å‚¨æˆå‘˜å’Œåˆ†æ•°çš„æ˜ å°„å…³ç³»ï¼Œæ”¯æŒå¿«é€Ÿçš„æˆå‘˜æŸ¥æ‰¾å’Œåˆ†æ•°æ›´æ–°ã€‚å“ˆå¸Œè¡¨ä¸­çš„é”®æ˜¯æˆå‘˜ï¼Œå€¼æ˜¯åˆ†æ•°ã€‚</li></ul></li></ol><p>è¿™ç§ç»“åˆäº†è·³è¡¨å’Œå“ˆå¸Œè¡¨çš„å®ç°æ–¹å¼ï¼Œä½¿å¾—ZSetåœ¨æ’å…¥ã€åˆ é™¤å’ŒæŸ¥æ‰¾æ“ä½œä¸Šå…·æœ‰é«˜æ•ˆçš„æ€§èƒ½</p><h2 id="rediså¤§keyã€çƒ­keyé—®é¢˜" tabindex="-1">Rediså¤§keyã€çƒ­keyé—®é¢˜ <a class="header-anchor" href="#rediså¤§keyã€çƒ­keyé—®é¢˜" aria-label="Permalink to &quot;Rediså¤§keyã€çƒ­keyé—®é¢˜&quot;">â€‹</a></h2><p>Redis çš„å¤§ Keyï¼ˆBig Keyï¼‰å’Œçƒ­ Keyï¼ˆHot Keyï¼‰æ˜¯å¸¸è§çš„æ€§èƒ½ç“¶é¢ˆé—®é¢˜ï¼Œéœ€è¦é’ˆå¯¹æ€§ä¼˜åŒ–ã€‚ä»¥ä¸‹æ˜¯å…·ä½“è§£å†³æ–¹æ¡ˆï¼š</p><hr><h3 id="ä¸€ã€å¤§-key-big-key-é—®é¢˜" tabindex="-1"><strong>ä¸€ã€å¤§ Keyï¼ˆBig Keyï¼‰é—®é¢˜</strong> <a class="header-anchor" href="#ä¸€ã€å¤§-key-big-key-é—®é¢˜" aria-label="Permalink to &quot;**ä¸€ã€å¤§ Keyï¼ˆBig Keyï¼‰é—®é¢˜**&quot;">â€‹</a></h3><p><strong>å®šä¹‰</strong>ï¼šå¤§ Key æ˜¯æŒ‡å•ä¸ª Key å­˜å‚¨çš„æ•°æ®é‡è¿‡å¤§ï¼ˆå¦‚è¶…è¿‡ 10KB çš„ Stringã€å…ƒç´ è¿‡ä¸‡çš„ Hash/Listã€æˆ–ä½“ç§¯è¿‡å¤§çš„å¤æ‚ç»“æ„ï¼‰ã€‚<br><strong>é£é™©</strong>ï¼šå†…å­˜ä¸å‡ã€æ“ä½œé˜»å¡ï¼ˆå¦‚ <code>DEL</code> å¡é¡¿ï¼‰ã€ç½‘ç»œå¸¦å®½å‹åŠ›ã€æŒä¹…åŒ–å»¶è¿Ÿã€‚</p><h4 id="è§£å†³æ–¹æ¡ˆ" tabindex="-1"><strong>è§£å†³æ–¹æ¡ˆ</strong> <a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ" aria-label="Permalink to &quot;**è§£å†³æ–¹æ¡ˆ**&quot;">â€‹</a></h4><ol><li><p><strong>æ‹†åˆ† Key</strong></p><ul><li><strong>åˆ†ç‰‡å­˜å‚¨</strong>ï¼šå°†å¤§ Key æŒ‰è§„åˆ™æ‹†åˆ†ä¸ºå¤šä¸ªå­ Keyã€‚ <ul><li>ç¤ºä¾‹ï¼šä¸€ä¸ª Hash å­˜å‚¨ç”¨æˆ·ä¿¡æ¯ï¼ŒæŒ‰ç”¨æˆ· ID åˆ†ç‰‡ä¸º <code>user_info:{user_id % 10}</code>ã€‚</li></ul></li><li><strong>åˆ†æ®µè¯»å–</strong>ï¼šä½¿ç”¨ <code>HSCAN</code>ã€<code>SSCAN</code> ç­‰å‘½ä»¤åˆ†æ‰¹æ“ä½œï¼Œé¿å…ä¸€æ¬¡æ€§åŠ è½½å…¨éƒ¨æ•°æ®ã€‚</li></ul></li><li><p><strong>é€‰æ‹©é«˜æ•ˆæ•°æ®ç»“æ„</strong></p><ul><li>é¿å…å¤§ String å­˜å‚¨ JSON æ•°æ®ï¼Œæ”¹ç”¨ Hash ç»“æ„ï¼ˆå­—æ®µçº§è¯»å†™ï¼‰ã€‚</li><li>ç”¨ <code>ziplist</code> ä¼˜åŒ–çš„ Hash/Listï¼ˆéœ€é…ç½® <code>hash-max-ziplist-entries</code> å’Œ <code>hash-max-ziplist-value</code>ï¼‰ã€‚</li><li>è¶…å¤§æ•°æ®é›†è€ƒè™‘ä½¿ç”¨ Redis Moduleï¼ˆå¦‚ <a href="https://redis.io/docs/stack/json/" target="_blank" rel="noreferrer">RedisJSON</a> æˆ– <a href="https://redis.io/docs/stack/search/" target="_blank" rel="noreferrer">RedisSearch</a>ï¼‰ã€‚</li></ul></li><li><p><strong>æ•°æ®å‹ç¼©</strong></p><ul><li>å¯¹ String ç±»å‹çš„ Value ä½¿ç”¨å‹ç¼©ç®—æ³•ï¼ˆå¦‚ Gzipã€Snappyï¼‰ï¼Œä½†éœ€æƒè¡¡ CPU å¼€é”€ã€‚</li><li>äºŒè¿›åˆ¶æ•°æ®å¯åºåˆ—åŒ–ä¸ºé«˜æ•ˆæ ¼å¼ï¼ˆå¦‚ Protocol Buffersï¼‰ã€‚</li></ul></li><li><p><strong>å¼‚æ­¥åˆ é™¤</strong></p><ul><li>ä½¿ç”¨ <code>UNLINK</code> æ›¿ä»£ <code>DEL</code> å‘½ä»¤ï¼ˆRedis 4.0+ï¼‰ï¼Œéé˜»å¡åˆ é™¤å¤§ Keyã€‚</li><li>é€šè¿‡ <code>Lazy Free</code> æœºåˆ¶ï¼ˆé…ç½® <code>lazyfree-lazy-user-del yes</code>ï¼‰å®ç°åå°æ¸…ç†ã€‚</li></ul></li><li><p><strong>åˆ†ç‰‡é›†ç¾¤</strong></p><ul><li>ä½¿ç”¨ Redis Cluster å°†å¤§ Key åˆ†å¸ƒåˆ°ä¸åŒèŠ‚ç‚¹ï¼Œåˆ†æ•£å†…å­˜å’Œè®¡ç®—å‹åŠ›ã€‚</li></ul></li><li><p><strong>é¢„é˜²ä¸ç›‘æ§</strong></p><ul><li>é€šè¿‡ <code>redis-cli --bigkeys</code> æ‰«æå¤§ Keyã€‚</li><li>ä½¿ç”¨ <code>MEMORY USAGE key</code> æŸ¥çœ‹ Key å†…å­˜å ç”¨ã€‚</li><li>å®šæœŸæ¸…ç†è¿‡æœŸæ•°æ®ï¼Œè®¾ç½®åˆç†çš„ TTLã€‚</li></ul></li><li><p>åŒºåˆ†å†·çƒ­æ•°æ®</p><p>ä¾‹å¦‚æ¦œå•åˆ—è¡¨åœºæ™¯ä½¿ç”¨ZSetï¼Œåªç¼“å­˜å‰10é¡µæ•°æ®ï¼Œåç»­æ•°æ®èµ°d&#39;b</p></li></ol><hr><h3 id="äºŒã€çƒ­-key-hot-key-é—®é¢˜" tabindex="-1"><strong>äºŒã€çƒ­ Keyï¼ˆHot Keyï¼‰é—®é¢˜</strong> <a class="header-anchor" href="#äºŒã€çƒ­-key-hot-key-é—®é¢˜" aria-label="Permalink to &quot;**äºŒã€çƒ­ Keyï¼ˆHot Keyï¼‰é—®é¢˜**&quot;">â€‹</a></h3><p><strong>å®šä¹‰</strong>ï¼šçƒ­ Key æ˜¯æŒ‡è¢«é«˜é¢‘è®¿é—®çš„ Keyï¼ˆå¦‚ç§’æ€å•†å“ã€çƒ­ç‚¹æ–°é—»ï¼‰ï¼Œå¯¼è‡´å•èŠ‚ç‚¹è´Ÿè½½è¿‡é«˜ã€‚<br><strong>é£é™©</strong>ï¼šCPU æ‰“æ»¡ã€ç½‘ç»œç“¶é¢ˆã€å•ç‚¹æ•…éšœã€‚</p><h4 id="è§£å†³æ–¹æ¡ˆ-1" tabindex="-1"><strong>è§£å†³æ–¹æ¡ˆ</strong> <a class="header-anchor" href="#è§£å†³æ–¹æ¡ˆ-1" aria-label="Permalink to &quot;**è§£å†³æ–¹æ¡ˆ**&quot;">â€‹</a></h4><ol><li><p><strong>æœ¬åœ°ç¼“å­˜ï¼ˆå®¢æˆ·ç«¯ç¼“å­˜ï¼‰</strong></p><ul><li>åœ¨åº”ç”¨å±‚ç¼“å­˜çƒ­ Key æ•°æ®ï¼ˆå¦‚ Guavaã€Caffeineï¼‰ï¼Œé™ä½ Redis è¯·æ±‚é¢‘ç‡ã€‚</li><li>è®¾ç½®åˆç†çš„æœ¬åœ°ç¼“å­˜è¿‡æœŸæ—¶é—´ï¼Œé¿å…æ•°æ®ä¸ä¸€è‡´ã€‚</li></ul></li><li><p><strong>å¤šçº§ç¼“å­˜</strong></p><ul><li>ç»“åˆ Redis + æœ¬åœ°ç¼“å­˜ + CDNï¼Œåˆ†æ•£å‹åŠ›ã€‚ä¾‹å¦‚ï¼š<div class="language-plaintext vp-adaptive-theme"><button title="Copy Code" class="copy"></button><span class="lang">plaintext</span><pre class="shiki shiki-themes github-light github-dark vp-code" tabindex="0"><code><span class="line"><span>è¯·æ±‚ â†’ CDN â†’ æœ¬åœ°ç¼“å­˜ â†’ Redis â†’ DB</span></span></code></pre></div></li></ul></li><li><p><strong>è¯»å†™åˆ†ç¦»</strong></p><ul><li>é€šè¿‡ Redis ä¸»ä»æ¶æ„ï¼Œå°†è¯»è¯·æ±‚åˆ†æµåˆ°ä»èŠ‚ç‚¹ï¼ˆéœ€æ³¨æ„ä¸»ä»å»¶è¿Ÿï¼‰ã€‚</li><li>ä½¿ç”¨ <code>READONLY</code> å‘½ä»¤å¼ºåˆ¶ä»èŠ‚ç‚¹å¤„ç†è¯»è¯·æ±‚ã€‚</li></ul></li><li><p><strong>Key æ‹†åˆ†</strong></p><ul><li><strong>æ¨ªå‘æ‹†åˆ†</strong>ï¼šå°†çƒ­ Key æ‹†åˆ†ä¸ºå¤šä¸ªå­ Keyï¼Œå¦‚ <code>hot_key:1</code>ã€<code>hot_key:2</code>ï¼Œé€šè¿‡è´Ÿè½½å‡è¡¡è½®è¯¢è®¿é—®ã€‚</li><li><strong>åˆ†æ¡¶ç­–ç•¥</strong>ï¼šå¯¹çƒ­ Key æ•°æ®åˆ†æ¡¶å­˜å‚¨ï¼Œä¾‹å¦‚æŒ‰ç”¨æˆ· ID å“ˆå¸Œåˆ°ä¸åŒå­ Keyã€‚</li></ul></li><li><p><strong>Redis é›†ç¾¤ä»£ç†</strong></p><ul><li>ä½¿ç”¨ä»£ç†å±‚ï¼ˆå¦‚ Twemproxyã€Codisï¼‰å°†çƒ­ Key è¯·æ±‚åˆ†æ•£åˆ°å¤šä¸ªèŠ‚ç‚¹ï¼ˆéœ€ç»“åˆåˆ†ç‰‡ç­–ç•¥ï¼‰ã€‚</li><li>å®¢æˆ·ç«¯åˆ†ç‰‡ï¼šåœ¨åº”ç”¨å±‚é€šè¿‡ä¸€è‡´æ€§å“ˆå¸Œå°†è¯·æ±‚è·¯ç”±åˆ°ä¸åŒå®ä¾‹ã€‚</li></ul></li><li><p><strong>é™æµä¸ç†”æ–­</strong></p><ul><li>å¯¹çƒ­ Key çš„è®¿é—®é™æµï¼ˆå¦‚ä»¤ç‰Œæ¡¶ç®—æ³•ï¼‰ï¼Œé˜²æ­¢çªå‘æµé‡å‡»ç©¿ Redisã€‚</li><li>ç†”æ–­æœºåˆ¶ï¼šåœ¨ Redis å‹åŠ›è¿‡å¤§æ—¶ï¼Œæš‚æ—¶é™çº§è¿”å›é»˜è®¤å€¼ã€‚</li></ul></li><li><p><strong>Redis åŸç”Ÿæ–¹æ¡ˆ</strong></p><ul><li><strong>Redis 6.0+ å®¢æˆ·ç«¯ç¼“å­˜</strong>ï¼šæœåŠ¡ç«¯æ”¯æŒå®¢æˆ·ç«¯ç¼“å­˜ï¼ˆServer-assisted Client-side Cachingï¼‰ï¼Œå‡å°‘é‡å¤æŸ¥è¯¢ã€‚</li><li><strong>RedisCell æ¨¡å—</strong>ï¼šé€šè¿‡ <code>CL.THROTTLE</code> å®ç°é™æµã€‚</li></ul></li></ol><hr><h3 id="ä¸‰ã€ç›‘æ§ä¸è‡ªåŠ¨åŒ–" tabindex="-1"><strong>ä¸‰ã€ç›‘æ§ä¸è‡ªåŠ¨åŒ–</strong> <a class="header-anchor" href="#ä¸‰ã€ç›‘æ§ä¸è‡ªåŠ¨åŒ–" aria-label="Permalink to &quot;**ä¸‰ã€ç›‘æ§ä¸è‡ªåŠ¨åŒ–**&quot;">â€‹</a></h3><ol><li><p><strong>å¤§ Key ç›‘æ§</strong></p><ul><li>ä½¿ç”¨ <code>redis-cli --bigkeys</code> å®šæœŸæ‰«æã€‚</li><li>é€šè¿‡ <code>MEMORY STATS</code> åˆ†æå†…å­˜åˆ†å¸ƒã€‚</li><li>ç¬¬ä¸‰æ–¹å·¥å…·ï¼šRedisInsightã€Prometheus + Grafanaã€‚</li></ul></li><li><p><strong>çƒ­ Key ç›‘æ§</strong></p><ul><li>Redis å‘½ä»¤ç»Ÿè®¡ï¼š<code>INFO commandstats</code> æŸ¥çœ‹é«˜é¢‘å‘½ä»¤ã€‚</li><li>ä½¿ç”¨ <code>redis-cli --hotkeys</code>ï¼ˆRedis 5.0+ï¼‰è¯†åˆ«çƒ­ Keyã€‚</li><li>å®æ—¶ç›‘æ§å·¥å…·ï¼šKeyDBã€é˜¿é‡Œäº‘ Redis çš„ã€Œçƒ­ Key åˆ†æã€åŠŸèƒ½ã€‚</li></ul></li><li><p><strong>è‡ªåŠ¨åŒ–å¤„ç†</strong></p><ul><li>é€šè¿‡è„šæœ¬å®šæœŸæ¸…ç†å¤§ Keyã€‚</li><li>ç»“åˆç›‘æ§ç³»ç»Ÿè§¦å‘å‘Šè­¦ï¼ˆå¦‚è¶…è¿‡é˜ˆå€¼è‡ªåŠ¨é™æµï¼‰ã€‚</li></ul></li></ol><hr><h3 id="å››ã€æ€»ç»“" tabindex="-1"><strong>å››ã€æ€»ç»“</strong> <a class="header-anchor" href="#å››ã€æ€»ç»“" aria-label="Permalink to &quot;**å››ã€æ€»ç»“**&quot;">â€‹</a></h3><table tabindex="0"><thead><tr><th>é—®é¢˜ç±»å‹</th><th>æ ¸å¿ƒæ€è·¯</th><th>å…·ä½“æ–¹æ¡ˆ</th></tr></thead><tbody><tr><td><strong>å¤§ Key</strong></td><td>æ‹†åˆ†ã€å‹ç¼©ã€å¼‚æ­¥æ¸…ç†</td><td>åˆ†ç‰‡å­˜å‚¨ã€<code>UNLINK</code>ã€<code>ziplist</code>ä¼˜åŒ–ã€é›†ç¾¤åˆ†ç‰‡</td></tr><tr><td><strong>çƒ­ Key</strong></td><td>åˆ†æ•£å‹åŠ›ã€å¤šçº§ç¼“å­˜</td><td>æœ¬åœ°ç¼“å­˜ã€è¯»å†™åˆ†ç¦»ã€Key æ‹†åˆ†ã€é™æµ</td></tr></tbody></table><p><strong>å…³é”®ç‚¹</strong>ï¼š</p><ul><li><strong>é¢„é˜²ä¼˜äºä¿®å¤</strong>ï¼šè®¾è®¡é˜¶æ®µé¿å…å¤§ Keyï¼Œä¸šåŠ¡å±‚æ§åˆ¶çƒ­ç‚¹ã€‚</li><li><strong>ç›‘æ§å¸¸æ€åŒ–</strong>ï¼šé€šè¿‡å·¥å…·å®æ—¶å‘ç°éšæ‚£ã€‚</li><li><strong>ç»“åˆä¸šåŠ¡åœºæ™¯</strong>ï¼šå¦‚ç§’æ€åœºæ™¯å¯æå‰é¢„çƒ­æ•°æ®ï¼Œç»“åˆæœ¬åœ°ç¼“å­˜ + é™æµã€‚</li></ul></div></div></main><footer class="VPDocFooter" data-v-39a288b8 data-v-e257564d><!--[--><!--]--><!----><nav class="prev-next" aria-labelledby="doc-footer-aria-label" data-v-e257564d><span class="visually-hidden" id="doc-footer-aria-label" data-v-e257564d>Pager</span><div class="pager" data-v-e257564d><a class="VPLink link pager-link prev" href="/Notes/Learning/Raft.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Pervious</span><span class="title" data-v-e257564d>Raft</span><!--]--></a></div><div class="pager" data-v-e257564d><a class="VPLink link pager-link next" href="/Notes/Learning/work-pool%E8%AE%BE%E8%AE%A1%E6%A8%A1%E5%BC%8F.html" data-v-e257564d><!--[--><span class="desc" data-v-e257564d>Next</span><span class="title" data-v-e257564d>work-poolè®¾è®¡æ¨¡å¼</span><!--]--></a></div></nav></footer><!--[--><!--]--></div></div></div><!--[--><!--]--></div></div><footer class="VPFooter has-sidebar" data-v-1f115b32 data-v-e315a0ad><div class="container" data-v-e315a0ad><p class="message" data-v-e315a0ad>Released under the MIT License.</p><p class="copyright" data-v-e315a0ad>Copyright @ &&2025</p></div></footer><!--[--><!--]--></div></div>
    <script>window.__VP_HASH_MAP__=JSON.parse("{\"friends.md\":\"CQINi6oD\",\"index.md\":\"CQtWuhd8\",\"notes_learning_capç†è®º.md\":\"DPsV-xtf\",\"notes_learning_cdn.md\":\"eh5uFbJU\",\"notes_learning_es.md\":\"CCyk7p5E\",\"notes_learning_go-base.md\":\"DNngAoK0\",\"notes_learning_raft.md\":\"Bi7Yz0OY\",\"notes_learning_redis.md\":\"C0gabYRo\",\"notes_learning_work-poolè®¾è®¡æ¨¡å¼.md\":\"BAm36VFg\",\"notes_learning_æ•°æ®åº“åˆ†åº“åˆ†è¡¨.md\":\"Dna-tIaa\",\"notes_learning_æ¶ˆæ¯é˜Ÿåˆ—.md\":\"BQxc2p8x\",\"notes_leetcode_3297. ç»Ÿè®¡é‡æ–°æ’åˆ—ååŒ…å«å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²æ•°ç›® i.md\":\"CVVDez6l\",\"notes_leetcode_lru.md\":\"CnIZcGGZ\",\"notes_leetcode_å•æºæœ€çŸ­è·¯å¾„.md\":\"DkGHqiPV\",\"notes_leetcode_å †æ’åº.md\":\"DyXG5W4F\",\"notes_leetcode_å¹¶æŸ¥é›†.md\":\"D84YAaYk\",\"notes_leetcode_å¿«é€Ÿæ’åº.md\":\"JcZY_NWA\",\"notes_leetcode_æœ€å°ä»£ä»·é—®é¢˜.md\":\"DC8lIZq-\"}");window.__VP_SITE_DATA__=JSON.parse("{\"lang\":\"en-US\",\"dir\":\"ltr\",\"title\":\"&&-blog\",\"description\":\"A-Cool-Blog\",\"base\":\"/\",\"head\":[],\"router\":{\"prefetchLinks\":true},\"appearance\":true,\"themeConfig\":{\"siteTitle\":\"welcome to my blog\",\"outlineTitle\":\"å¯¼èˆªæ \",\"search\":{\"provider\":\"local\"},\"docFooter\":{\"prev\":\"Pervious\",\"next\":\"Next\"},\"footer\":{\"message\":\"Released under the MIT License.\",\"copyright\":\"Copyright @ &&2025\"},\"logo\":\"/image.png\",\"nav\":[{\"frontMatter\":{},\"link\":\"friends.md\",\"content\":\"animationtitlefriends\",\"uuid\":\"e3f998e9-9967-4123-a54a-7e5649b2b22f\",\"id\":\"784c84fc-b674-4e25-8903-ad88cc460303\",\"text\":\"friends\",\"level\":0,\"dir\":\"\"},{\"text\":\"Notes\",\"id\":\"08116fe0-3d2f-44e1-8f87-c77c1130b8d1\",\"parentId\":\"\",\"items\":[{\"text\":\"Learning\",\"id\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"parentId\":\"08116fe0-3d2f-44e1-8f87-c77c1130b8d1\",\"items\":[{\"text\":\"æ•°æ®åº“åˆ†åº“åˆ†è¡¨\",\"link\":\"/Notes/Learning/æ•°æ®åº“åˆ†åº“åˆ†è¡¨.md\",\"id\":\"8bddd20a-c67c-4724-86ae-9f78c83b8108\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]},{\"text\":\"æ¶ˆæ¯é˜Ÿåˆ—\",\"link\":\"/Notes/Learning/æ¶ˆæ¯é˜Ÿåˆ—.md\",\"id\":\"1d7c4e84-2564-4772-8a2e-65164824c0c2\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]},{\"text\":\"CAPç†è®º\",\"link\":\"/Notes/Learning/CAPç†è®º.md\",\"id\":\"05c6720d-025b-4492-9996-47e075431486\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]},{\"text\":\"CDN\",\"link\":\"/Notes/Learning/CDN.md\",\"id\":\"96cbf9a3-e043-404e-9946-3da17d729a47\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]},{\"text\":\"ES\",\"link\":\"/Notes/Learning/ES.md\",\"id\":\"6927fb44-e779-4250-97ce-151b84b38eb0\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]},{\"text\":\"Go-base\",\"link\":\"/Notes/Learning/Go-base.md\",\"id\":\"8f4ad0c2-195a-458d-bf53-6e13b77413f4\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]},{\"text\":\"Raft\",\"link\":\"/Notes/Learning/Raft.md\",\"id\":\"a0a86229-4fe9-492d-b8b2-7cc04c629ed3\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]},{\"text\":\"Redis\",\"link\":\"/Notes/Learning/Redis.md\",\"id\":\"a51271fc-dc04-4345-874d-96fbb6b34a35\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]},{\"text\":\"work-poolè®¾è®¡æ¨¡å¼\",\"link\":\"/Notes/Learning/work-poolè®¾è®¡æ¨¡å¼.md\",\"id\":\"f2b1f0a4-8c1c-4700-aee6-d1b0e23d4a8b\",\"parentId\":\"ae9435f5-8a7a-4a18-8c09-0022f6fd44ab\",\"items\":[]}]},{\"text\":\"leetcode\",\"id\":\"cdbc61ce-dc36-41b4-a31b-f9555373e443\",\"parentId\":\"08116fe0-3d2f-44e1-8f87-c77c1130b8d1\",\"items\":[{\"text\":\"3297. ç»Ÿè®¡é‡æ–°æ’åˆ—ååŒ…å«å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²æ•°ç›® I\",\"link\":\"/Notes/leetcode/3297. ç»Ÿè®¡é‡æ–°æ’åˆ—ååŒ…å«å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²æ•°ç›® I.md\",\"id\":\"40f56b11-5aca-4d12-b54f-8216163ed810\",\"parentId\":\"cdbc61ce-dc36-41b4-a31b-f9555373e443\",\"items\":[]},{\"text\":\"å¹¶æŸ¥é›†\",\"link\":\"/Notes/leetcode/å¹¶æŸ¥é›†.md\",\"id\":\"f34b94f4-caac-4ba1-ab65-c08671615506\",\"parentId\":\"cdbc61ce-dc36-41b4-a31b-f9555373e443\",\"items\":[]},{\"text\":\"å•æºæœ€çŸ­è·¯å¾„\",\"link\":\"/Notes/leetcode/å•æºæœ€çŸ­è·¯å¾„.md\",\"id\":\"034c2c5f-351e-40fb-9fb1-59da982f123f\",\"parentId\":\"cdbc61ce-dc36-41b4-a31b-f9555373e443\",\"items\":[]},{\"text\":\"å †æ’åº\",\"link\":\"/Notes/leetcode/å †æ’åº.md\",\"id\":\"94c2b4c6-fce4-4c98-b9d7-8765e0eb7821\",\"parentId\":\"cdbc61ce-dc36-41b4-a31b-f9555373e443\",\"items\":[]},{\"text\":\"å¿«é€Ÿæ’åº\",\"link\":\"/Notes/leetcode/å¿«é€Ÿæ’åº.md\",\"id\":\"adca68ca-7f3c-41a4-9a17-b407dd013cac\",\"parentId\":\"cdbc61ce-dc36-41b4-a31b-f9555373e443\",\"items\":[]},{\"text\":\"æœ€å°ä»£ä»·é—®é¢˜\",\"link\":\"/Notes/leetcode/æœ€å°ä»£ä»·é—®é¢˜.md\",\"id\":\"d030c95b-6beb-4c0e-a1b9-caeb6debc07b\",\"parentId\":\"cdbc61ce-dc36-41b4-a31b-f9555373e443\",\"items\":[]},{\"text\":\"LRU\",\"link\":\"/Notes/leetcode/LRU.md\",\"id\":\"6d9cc1b0-bf28-4d78-bdb2-3d12d0b4e89b\",\"parentId\":\"cdbc61ce-dc36-41b4-a31b-f9555373e443\",\"items\":[]}]}]},{\"text\":\"ğŸ¤¡ å…³äºæˆ‘\",\"link\":\"/\"},{\"text\":\"ğŸ˜ æ˜é‡‘\",\"link\":\"https://juejin.cn/user/4466629837071787\"}],\"socialLinks\":[{\"icon\":\"gitee\",\"link\":\"https://gitee.com/chen-yuki238\"},{\"icon\":\"juejin\",\"link\":\"https://juejin.cn/user/4466629837071787\"},{\"icon\":\"github\",\"link\":\"https://github.com/\"}],\"sidebar\":{\"/Notes/\":[{\"text\":\"Notes\",\"collapsed\":false,\"items\":[{\"text\":\"Learning\",\"id\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"dir\":\"Notes/Learning\",\"parentId\":\"349d4ed9-a076-47e4-8a2a-407a88bfe0a4\",\"collapsed\":false,\"items\":[{\"text\":\"æ•°æ®åº“åˆ†åº“åˆ†è¡¨\",\"id\":\"638c32d7-5617-44fc-ad0b-583614e416cb\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/æ•°æ®åº“åˆ†åº“åˆ†è¡¨.md\",\"items\":[]},{\"text\":\"æ¶ˆæ¯é˜Ÿåˆ—\",\"id\":\"7c0e229e-b679-4342-a86e-e7c4566b13fe\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/æ¶ˆæ¯é˜Ÿåˆ—.md\",\"items\":[]},{\"text\":\"CAPç†è®º\",\"id\":\"049ab53c-9cc3-40e9-b3d4-c1aa62ec79a5\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/CAPç†è®º.md\",\"items\":[]},{\"text\":\"CDN\",\"id\":\"a2ee770a-3808-4098-b7b6-342388a18d60\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/CDN.md\",\"items\":[]},{\"text\":\"ES\",\"id\":\"54f202f5-6ffe-4f44-b804-160ec6e668c7\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/ES.md\",\"items\":[]},{\"text\":\"Go-base\",\"id\":\"ab82c56e-b17d-482b-a0b5-d7e5723810be\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/Go-base.md\",\"items\":[]},{\"text\":\"Raft\",\"id\":\"050bf7c7-2bae-463f-b9de-3a5138275f6d\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/Raft.md\",\"items\":[]},{\"text\":\"Redis\",\"id\":\"ca711057-bf5e-4b44-9b89-e7ccc1052002\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/Redis.md\",\"items\":[]},{\"text\":\"work-poolè®¾è®¡æ¨¡å¼\",\"id\":\"965a9c5e-f905-4cef-a20a-1f402d1739ab\",\"dir\":\"Notes/Learning\",\"parentId\":\"e803abc1-c039-4b5f-9527-cba9561ce12a\",\"link\":\"/Notes/Learning/work-poolè®¾è®¡æ¨¡å¼.md\",\"items\":[]}]},{\"text\":\"leetcode\",\"id\":\"801f5ac9-4887-41ae-8ee9-06f6c3a05cd6\",\"dir\":\"Notes/leetcode\",\"parentId\":\"349d4ed9-a076-47e4-8a2a-407a88bfe0a4\",\"collapsed\":false,\"items\":[{\"text\":\"3297. ç»Ÿè®¡é‡æ–°æ’åˆ—ååŒ…å«å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²æ•°ç›® I\",\"id\":\"475d5144-df63-4b09-a8b3-2b38055c92d0\",\"dir\":\"Notes/leetcode\",\"parentId\":\"801f5ac9-4887-41ae-8ee9-06f6c3a05cd6\",\"link\":\"/Notes/leetcode/3297. ç»Ÿè®¡é‡æ–°æ’åˆ—ååŒ…å«å¦ä¸€ä¸ªå­—ç¬¦ä¸²çš„å­å­—ç¬¦ä¸²æ•°ç›® I.md\",\"items\":[]},{\"text\":\"å¹¶æŸ¥é›†\",\"id\":\"432c02a6-83c0-4e25-a2a1-98d320c23702\",\"dir\":\"Notes/leetcode\",\"parentId\":\"801f5ac9-4887-41ae-8ee9-06f6c3a05cd6\",\"link\":\"/Notes/leetcode/å¹¶æŸ¥é›†.md\",\"items\":[]},{\"text\":\"å•æºæœ€çŸ­è·¯å¾„\",\"id\":\"65066368-83c9-4973-837b-0899868461a6\",\"dir\":\"Notes/leetcode\",\"parentId\":\"801f5ac9-4887-41ae-8ee9-06f6c3a05cd6\",\"link\":\"/Notes/leetcode/å•æºæœ€çŸ­è·¯å¾„.md\",\"items\":[]},{\"text\":\"å †æ’åº\",\"id\":\"29ba9d4e-6577-446e-8fc0-4592f7b4fad8\",\"dir\":\"Notes/leetcode\",\"parentId\":\"801f5ac9-4887-41ae-8ee9-06f6c3a05cd6\",\"link\":\"/Notes/leetcode/å †æ’åº.md\",\"items\":[]},{\"text\":\"å¿«é€Ÿæ’åº\",\"id\":\"a1d3e2a0-5ab8-4ff5-be80-df5f26e07158\",\"dir\":\"Notes/leetcode\",\"parentId\":\"801f5ac9-4887-41ae-8ee9-06f6c3a05cd6\",\"link\":\"/Notes/leetcode/å¿«é€Ÿæ’åº.md\",\"items\":[]},{\"text\":\"æœ€å°ä»£ä»·é—®é¢˜\",\"id\":\"d0b2611d-c7e1-48c7-968c-fdcb082ddd47\",\"dir\":\"Notes/leetcode\",\"parentId\":\"801f5ac9-4887-41ae-8ee9-06f6c3a05cd6\",\"link\":\"/Notes/leetcode/æœ€å°ä»£ä»·é—®é¢˜.md\",\"items\":[]},{\"text\":\"LRU\",\"id\":\"67a8cc00-3cf4-4e01-9589-d54a79d3060e\",\"dir\":\"Notes/leetcode\",\"parentId\":\"801f5ac9-4887-41ae-8ee9-06f6c3a05cd6\",\"link\":\"/Notes/leetcode/LRU.md\",\"items\":[]}]}]}]}},\"locales\":{},\"scrollOffset\":134,\"cleanUrls\":false}");</script>
    
  </body>
</html>